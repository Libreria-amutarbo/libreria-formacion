<div class="dcx-search">
  <div class="dcx-search__container">
    <dcx-ng-input
      #searchInput
      class="dcx-search__input"
      [placeholder]="placeholder()"
      [disabled]="disabled()"
      [size]="size()"
      [search]="true"
      (valueChange)="onValueChange($event)"
    />

    @if (showClear() && searchValue()) {
      <dcx-ng-button
        class="dcx-search__clear-button"
        [ariaLabel]="'Limpiar'"
        [disabled]="disabled()"
        [variant]="'icon'"
        [size]="size()"
        [iconStart]="'x'"
        [iconSize]="size() === 's' ? 'm' : size() === 'm' ? 'l' : 'xl'"
        (buttonClick)="onClearClick()"
      />
    }

    <dcx-ng-button
      class="dcx-search__search-button"
      [ariaLabel]="'Buscar'"
      [disabled]="disabled()"
      [variant]="'icon'"
      [size]="size()"
      [iconStart]="'search'"
      [iconSize]="size()"
      (buttonClick)="onSearchClick()"
    />

    @if (dropdown()) {
      <dcx-ng-button
        class="dcx-search__dropdown-button"
        [ariaLabel]="'Abrir opciones'"
        [disabled]="disabled()"
        [variant]="'icon'"
        [size]="size()"
        [iconStart]="'chevron-down'"
        [iconSize]="size()"
        (buttonClick)="onDropdownClick()"
      />
    }

    @if (dropdown() && isDropdownOpen() && filteredItems().length > 0) {
      <div class="dcx-search__dropdown">
        <ul class="dcx-search__dropdown-list">
          @for (item of filteredItems(); track item.id) {
            <li 
              class="dcx-search__dropdown-item"
              (click)="onItemClick(item)"
              tabindex="0"
            >
              {{ item.label }}
            </li>
          }
        </ul>
      </div>
    }

    @if (dropdown() && isDropdownOpen() && filteredItems().length === 0 && searchValue()) {
      <div class="dcx-search__dropdown">
        <p class="dcx-search__dropdown-empty">No se encontraron resultados</p>
      </div>
    }
  </div>
</div>
