<div class="accordion" [class]="getTransitionClass()">
  @for (item of items(); track item.id; let i = $index) {
    <div 
      class="accordion-item" 
      [class.disabled]="item.disabled"
      [class.expanded]="isExpanded(item.id)"
    >
        <div 
          class="accordion-header"
          [class.expanded]="isExpanded(item.id)"
          [class.disabled]="item.disabled"
          [attr.id]="'accordion-header-' + item.id"
          [attr.aria-expanded]="isExpanded(item.id)"
          [attr.aria-controls]="'accordion-content-' + item.id"
          [attr.role]="'button'"
          [attr.tabindex]="item.disabled ? -1 : 0"
          (click)="!item.disabled && onButtonClick(item)"
          (keydown.enter)="!item.disabled && onButtonClick(item)"
          (keydown.space)="!item.disabled && onHeaderKeydown($any($event), item)"
        >
          @if (item.icon) {
            <dcx-ng-icon 
              class="accordion-icon" 
              [name]="item.icon"
              [size]="'m'">
            </dcx-ng-icon>
          }
          <span class="accordion-title">{{ item.title }}</span>
          <dcx-ng-icon
            class="accordion-chevron"
            name="chevron-down"
            [size]="'s'">
          </dcx-ng-icon>
        </div>

        <div
          class="accordion-content-wrapper"
          [class.expanded]="isExpanded(item.id)"
          [class.disabled-content]="item.disabledContent"
          [attr.id]="'accordion-content-' + item.id"
          [attr.aria-labelledby]="'accordion-header-' + item.id"
          role="region"
        >
          <div class="accordion-content">
            @if (item.contentTemplate) {
              <ng-container *ngTemplateOutlet="item.contentTemplate"></ng-container>
            } @else {
              <div [innerHTML]="item.content"></div>
            }
          </div>
        </div>
      </div>
    }
  </div>
